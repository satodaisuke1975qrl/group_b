{% extends 'base.html' %}

{% block content %}
    <h1>番組詳細</h1>

    <table class="detail">
        <tr>
            <th>放送日</th>
            <td>{{ tv.date.on_air_date }}</td>
        </tr>
        <tr>
            <th>放送時間</th>
            <td>{{ tv.get_time_hour_and_minute }}</td>
        </tr>
        <tr>
            <th>タイトル</th>
            <td>{{ tv.program_name }}</td>
        </tr>
        <tr>
            <th>番組内容</th>
            <td>{{ tv.content }}</td>
        </tr>
        <tr>
            <th>カテゴリ</th>
            <td>{{ tv.category }}</td>
        </tr>
    </table>

<br>

    <div class="btn back">
        <a href="{% url 'tvasahi:tv_list' tv.date.pk %}">番組一覧へ戻る</a>
    </div>

    <h1>コメント欄</h1>
    {% for comment in tv.comment_set.all %}

        <h4>{{ comment.user_name.username }} : {{ comment.pub_date|date:"Y/m/d(D) H:i:s" }}</h4>

        <div>
            <p>{{ comment.comment | linebreaks }}</p>
        </div>

        {% if comment.user_name.username == user.username %}
            <form name="delete{{ comment.pk }}" method="post" action="{% url 'tvasahi:comment_delete' comment.pk %}">
                {% csrf_token %}
                <button type="button" class="btn btn-danger" onclick="msgdsp('delete{{ comment.pk }}')" >削除</button>
            </form>
        {% endif %}
        <hr>
    {% endfor %}

    <div class="btn btndetail">
        <a href="{% url 'tvasahi:comment_create' tv.id %}">コメント投稿</a>
    </div>



{% endblock %}

{% block extra_js %}

  <script>
    function msgdsp(name){
    var confirmDelete = confirm('本当に削除しますか？');
      if (confirmDelete) {
        const form = document.getElementsByName(name)[0]
        form.submit()
      }
    }

  </script>
{% endblock %}